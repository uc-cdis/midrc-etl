metadata:
  name: s30
  namespace: argo
spec:
  entrypoint: main
  templates:
    - name: main 
      steps:
        - - name: step1
            template: step1-install-packages
            arguments: {}
        - - name: step2
            template: step2-run-py-script
            arguments: {}
    - name: step1-install-packages
      container:
        name: midrcpod
        image: "quay.io/cdis/midrc-etl:v3"
        imagePullPolicy: "Always"
        command:
          - bash
          - -c
        args:
          - echo "installing packages";
            poetry run python /midrc-etl/v3/package_series.py;
            echo "packages installed"; 
            echo "start script";
            cd v3; 
            ls;
            echo "end script";
    - name: step2-run-py-script
      container:
        name: midrcpod
        image: "quay.io/cdis/midrc-etl:v3"
        command:
          - bash
          - -c
        args:
          - echo "Test Step 2";